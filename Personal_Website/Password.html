<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <title>Password Required</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
        }
        #dialogText {
            padding: 10px 30px;
            color: white;
            background-color: #333333;
        }
        
        #dialogWrap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: table;
            background-color: #EEEEEE;
        }
        
        #dialogWrapCell {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        #mainDialog {
            max-width: 400px;
            margin: 5px;
            border: solid #AAAAAA 1px;
            border-radius: 10px;
            box-shadow: 3px 3px 5px 3px #AAAAAA;
            margin-left: auto;
            margin-right: auto;
            background-color: #FFFFFF;
            overflow: hidden;
            text-align: left;
        }
        #passArea {
            padding: 20px 30px;
            background-color: white;
        }
        #passArea > * {
            margin: 5px auto;
        }
        #pass {
            width: 100%;
            height: 40px;
            font-size: 30px;
        }
        
        #messageWrapper {
            float: left;
            vertical-align: middle;
            line-height: 30px;
        }
        
        .notifyText {
            display: none;
        }
        
        #invalidPass {
            color: red;
        }
        
        #success {
            color: green;
        }
        
        #submitPass {
            font-size: 20px;
            border-radius: 5px;
            background-color: #E7E7E7;
            border: solid gray 1px;
            float: right;
        }
        #contentFrame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
  </head>
  <body>
    <iframe id="contentFrame" frameBorder="0" allowfullscreen></iframe>
    <div id="dialogWrap">
        <div id="dialogWrapCell">
            <div id="mainDialog">
                <div id="dialogText">This website requires a password to view.</div>
                <div id="passArea">
                    <p id="passwordPrompt">Password</p>
                    <input id="pass" type="password" name="pass">
                    <div>
                        <span id="messageWrapper">
                            <span id="invalidPass" class="notifyText">Sorry, please try again.</span>
                            <span id="success" class="notifyText">Success!</span>
                            &nbsp;
                        </span>
                        <button id="submitPass" type="button">Submit</button>
                        <div style="clear: both;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/pbkdf2.js"></script>
    <script>
        /*! srcdoc-polyfill - v0.1.1 - 2013-03-01
        * http://github.com/jugglinmike/srcdoc-polyfill/
        * Copyright (c) 2013 Mike Pennisi; Licensed MIT */
        (function( window, document, undefined ) {
	
	        var idx, iframes;
	        var _srcDoc = window.srcDoc;
	        var isCompliant = !!("srcdoc" in document.createElement("iframe"));
	        var implementations = {
		        compliant: function( iframe, content ) {

			        if (content) {
				        iframe.setAttribute("srcdoc", content);
			        }
		        },
		        legacy: function( iframe, content ) {

			        var jsUrl;

			        if (!iframe || !iframe.getAttribute) {
				        return;
			        }

			        if (!content) {
				        content = iframe.getAttribute("srcdoc");
			        } else {
				        iframe.setAttribute("srcdoc", content);
			        }

			        if (content) {
				        // The value returned by a script-targeted URL will be used as
				        // the iFrame's content. Create such a URL which returns the
				        // iFrame element's `srcdoc` attribute.
				        jsUrl = "javascript: window.frameElement.getAttribute('srcdoc');";

				        iframe.setAttribute("src", jsUrl);

				        // Explicitly set the iFrame's window.location for
				        // compatability with IE9, which does not react to changes in
				        // the `src` attribute when it is a `javascript:` URL, for
				        // some reason
				        if (iframe.contentWindow) {
					        iframe.contentWindow.location = jsUrl;
				        }
			        }
		        }
	        };
	        var srcDoc = window.srcDoc = {
		        // Assume the best
		        set: implementations.compliant,
		        noConflict: function() {
			        window.srcDoc = _srcDoc;
			        return srcDoc;
		        }
	        };

	        // If the browser supports srcdoc, no shimming is necessary
	        if (isCompliant) {
		        return;
	        }

	        srcDoc.set = implementations.legacy;

	        // Automatically shim any iframes already present in the document
	        iframes = document.getElementsByTagName("iframe");
	        idx = iframes.length;

	        while (idx--) {
		        srcDoc.set( iframes[idx] );
	        }

        }( this, this.document ));
    </script>
    <script>
        var pl = {"salt":"xgKynWiOuslzCvTZsdrzVZMuuds3KCTFtPzLVwKdYEc=","iv":"fSQI5k724rU14HJfg+la+w==","data":"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"};
        
        var submitPass = document.getElementById('submitPass');
        var passEl = document.getElementById('pass');
        var invalidPassEl = document.getElementById('invalidPass');
        var successEl = document.getElementById('success');
        var contentFrame = document.getElementById('contentFrame');
        
        if (pl === "") {
            submitPass.disabled = true;
            passEl.disabled = true;
            alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
        }
        
        function doSubmit(evt) {
            try {
                var decrypted = decryptFile(CryptoJS.enc.Base64.parse(pl.data), passEl.value, CryptoJS.enc.Base64.parse(pl.salt), CryptoJS.enc.Base64.parse(pl.iv));
                if (decrypted === "") throw "No data returned";
                
                // Set default iframe link targets to _top so all links break out of the iframe
                decrypted = decrypted.replace("<head>", "<head><base href=\".\" target=\"_top\">");
                
                srcDoc.set(contentFrame, decrypted);
                
                successEl.style.display = "inline";
                passEl.disabled = true;
                submitPass.disabled = true;
                setTimeout(function() {
                    dialogWrap.style.display = "none";
                }, 1000);
            } catch (e) {
                invalidPassEl.style.display = "inline";
                passEl.value = "";
            }
        }
        
        submitPass.onclick = doSubmit;
        passEl.onkeypress = function(e){
            if (!e) e = window.event;
            var keyCode = e.keyCode || e.which;
            invalidPassEl.style.display = "none";
            if (keyCode == '13'){
              // Enter pressed
              doSubmit();
              return false;
            }
        }
        
        function decryptFile(contents, password, salt, iv) {
            var _cp = CryptoJS.lib.CipherParams.create({
                ciphertext: contents
            });
            var key = CryptoJS.PBKDF2(password, salt, { keySize: 256/32, iterations: 100 });
            var decrypted = CryptoJS.AES.decrypt(_cp, key, {iv: iv});
            
            return decrypted.toString(CryptoJS.enc.Utf8);
        }
    </script>
  </body>
</html>
